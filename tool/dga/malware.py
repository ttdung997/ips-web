import random
import time
import sys
import math
import pandas as pd
from lib.connect_sqlite import Database

add_dga = ("INSERT INTO bkcs_malware "
               "(name, type , summary,techical,risk_level,recommendation) "
               "VALUES (?,?,?,?,?,?)")

mysql = Database()
mysql.connectDB() 
fields =['DGA Botnet','TLD','SLD','Time Dependent','E.g','Code']

MasterDataframe = pd.read_excel('dga.xlsx')
# MasterDataframe = MasterDataframe[fields]

print(MasterDataframe)

Data = MasterDataframe.values

for Line in Data:
 	name = Line[0]
 	typeID = 'malware'
	summary = '<ul><li>TSD: '+Line[1]+'</li>'
	summary = summary + '<li>SLD: '+Line[2]+'</li>'
	summary = summary + '<li>Time Dependent: '+Line[3]+'</li></ul>'
	eg = Line[4].split("\n")
	techical = 'Exmaple:<br> ';
	for eg in eg:
		techical = techical +eg+'<br>';
	try:
		if math.isnan(Line[5]) :
			recommendation = ''
		else:
			recommendation=Line[5] 
	except:
		recommendation=Line[5] 

	data = (name,typeID,summary,techical,2,'')
	mysql.query_table(add_dga,data)



